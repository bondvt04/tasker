{"version":3,"sources":["controllers/index.js"],"names":[],"mappings":";;;;;;;;AAAA,IAAI,IAAI,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAC;AACrC,IAAI,OAAO,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC;;IAE3B,UAAU;aAAV,UAAU;8BAAV,UAAU;;;iBAAV,UAAU;;eAEE,0BAAG,EAEhB;;;eAEY,uBAAC,IAAI,EAAE;AAChB,gBAAI,EAAE,CAAC;SACV;;;eAEO,kBAAC,UAAU,EAAE,IAAI,EAAE;AACvB,gBAAI,YAAY,GAAG,GAAG,GAAC,UAAU,GAAC,QAAQ,CAAC;AAC3C,gBAAI,IAAI,GAAG,IAAI,CAAC;AAChB,gBAAI,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;;AAEnB,gBAAG,IAAI,CAAC,YAAY,CAAC,IAAI,UAAU,KAAK,OAAO,IAAI,CAAC,YAAY,CAAC,EAAE;AAC/D,oBAAI,CAAC,cAAc,EAAE,CAAC;;;AAGtB,oBAAI,aAAa,GAAG,IAAI,CAAC,YAAY,OAAC,CAAlB,IAAI,qBAAkB,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,EAAC,CAAC;;AAE5E,6BAAa,CAAC,IAAI,CAAC,UAAS,MAAM,EAAE;AAChC,wBAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;iBAC5B,CAAC,SAAM,CAAC,UAAS,GAAG,EAAE;AACnB,2BAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;iBACtB,CAAC,CAAC;aACN;SACJ;;;eAEW,sBAAC,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE;AACzB,gBAAI,KAAK,GAAG,IAAI,IAAI,CAAC;AACjB,uBAAO,EAAE,eAAe;aAC3B,CAAC,CAAC;;AAEH,gBAAI,WAAW,GAAG,IAAI,OAAO,CAAC,UAAS,OAAO,EAAE,MAAM,EAAE;AACpD,qBAAK,CAAC,IAAI,CAAC,UAAU,GAAG,EAAE,IAAI,EAAE;AAC5B,wBAAI,GAAG,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC;;AAErB,2BAAO,CAAC,GAAG,CAAC,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;AACjC,2BAAO,CAAC,IAAI,CAAC,CAAC;iBACjB,CAAC,CAAC;aACN,CAAC,CAAC;;AAEH,gBAAI,WAAW,GAAG,IAAI,OAAO,CAAC,UAAS,OAAO,EAAE,MAAM,EAAE;AACpD,oBAAI,CAAC,IAAI,CAAC,UAAU,GAAG,EAAE,KAAK,EAAE;AAC5B,wBAAI,GAAG,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC;AACrB,2BAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;;AAEnB,2BAAO,CAAC,KAAK,CAAC,CAAC;iBAClB,CAAC,CAAC;;;aAGN,CAAC,CAAC;;AAEH,mBAAO,IAAI,OAAO,CAAC,UAAS,OAAO,EAAE,MAAM,EAAE;AACzC,uBAAO,CAAC,GAAG,CAAC,CACR,WAAW,EACX,WAAW,CACd,CAAC,CAAC,IAAI,CAAC,UAAS,OAAO,EAAE;AACtB,2BAAO,EAAE,CAAC;iBACb,CAAC,SAAM,CAAC,UAAS,GAAG,EAAE;AACnB,0BAAM,EAAE,CAAC;iBACZ,CAAC,CAAC;aACN,CAAC,CAAC;SACN;;;WAhEC,UAAU;;;AAmEhB,MAAM,CAAC,OAAO,GAAG,IAAI,UAAU,EAAE,CAAC","file":"controllers/index.js","sourcesContent":["var Node = require(\"../models/Node\");\nvar Promise = require(\"promise\");\n\nclass Controller {\n\n    __beforeAction() {\n\n    }\n\n    __afterAction(next) {\n        next();\n    }\n\n    doAction(actionName, args) {\n        var functionName = \"_\"+actionName+\"Action\";\n        var self = this;\n        var next = args[2];\n\n        if(this[functionName] && \"function\" === typeof this[functionName]) {\n            this.__beforeAction();\n\n            // fill with arguments as is (not as array)\n            var actionPromise = this[functionName](...Array.prototype.slice.call(args));\n\n            actionPromise.then(function(result) {\n                self.__afterAction(next);\n            }).catch(function(err) {\n                console.error(err);\n            });\n        }\n    }\n\n    _indexAction(req, res, next) {\n        var hello = new Node({\n            content: 'Hello, World!'\n        });\n\n        var savePromise = new Promise(function(resolve, reject) {\n            hello.save(function (err, node) {\n                if (err) reject(err);\n\n                console.log(\"###\", node.content);\n                resolve(node);\n            });\n        });\n\n        var findPromise = new Promise(function(resolve, reject) {\n            Node.find(function (err, nodes) {\n                if (err) reject(err);\n                console.log(nodes);\n\n                resolve(nodes);\n            });\n\n            //Kitten.find({ name: /^Fluff/ }, callback);\n        });\n\n        return new Promise(function(resolve, reject) {\n            Promise.all([\n                savePromise,\n                findPromise\n            ]).then(function(results) {\n                resolve();\n            }).catch(function(err) {\n                reject();\n            });\n        });\n    }\n}\n\nmodule.exports = new Controller();\n"],"sourceRoot":"/source/"}