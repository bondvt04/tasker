{"version":3,"sources":["controllers/index.js"],"names":[],"mappings":"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","file":"controllers/index.js","sourcesContent":["// for consoles\nvar logger = require(\"verbose-console-log\");\nvar Node = require(\"../models/Node\");\nvar ApiControllerAbstract = require(\"./apiControllerAbstract\");\n\n//var querystring = require(\"querystring\");\n\nclass Controller extends ApiControllerAbstract {\n\n    constructor() {\n        super(arguments);\n    }\n\n    //__beforeAction(req, res, next) {\n    //    console.log(\"Controller.__beforeAction\");\n    //    return super.__beforeAction.apply(this, arguments);\n    //}\n    //\n    //__afterAction(req, res, next, actionResult) {\n    //    console.log(\"Controller.__afterAction\");\n    //    return super.__afterAction.apply(this, arguments);\n    //}\n\n\n\n    //doAction(actionName, args) {\n    //    return new Promise(function(resolve, reject) {\n    //        do_.something.wrong();\n    //        //throw new Error(\"lol there are error occured\");\n    //    });\n    //}\n\n\n\n    /**\n     * Тестим ловлю ошибок\n     */\n    _error500Action(req, res) {\n        return new Promise(function(resolve, reject) {\n            try {\n                console.log(\"_error500Action\");\n                lol.hello.ololo();\n                throw new Error(\"zlo\");\n            } catch(e) {\n                console.log(\"### 1\");\n                reject(e);\n            }\n        });\n    }\n\n    /**\n     * @todo Add filter, tags etc logic\n     * @todo do res.end() in the end, not in controller\n     */\n    _getNodesAction(req, res) {\n        return new Promise(function(resolve, reject) {\n            resolve({a:\"asdf\", b:\"bsdf\"});\n            //Node.find(function (err, nodes) {\n            //    if (err) reject(err);\n            //\n            //    res.send(nodes);\n            //\n            //    resolve(nodes);\n            //});\n\n            //Kitten.find({ name: /^Fluff/ }, callback);\n        });\n    }\n\n    _addNodeAction(req, res) {\n        var newNode = new Node(req.body);\n\n        return new Promise(function(resolve, reject) {\n            newNode.save(function (err, node) {\n                if (err) reject(err);\n\n                console.log(\"___savePromise\", node);\n                resolve(node);\n            });\n        });\n    }\n\n    _indexAction(req, res) {\n        return new Promise(function(resolve, reject) {\n            res.send(\"just /index action\");\n            resolve();\n        });\n    }\n\n    _testAction(req, res) {\n        var hello = new Node({\n            content: 'Hello, World!'\n        });\n\n        var savePromise = new Promise(function(resolve, reject) {\n            hello.save(function (err, node) {\n                if (err) reject(err);\n\n                console.log(\"___savePromise\", node.content);\n                resolve(node);\n            });\n        });\n\n        var findPromise = new Promise(function(resolve, reject) {\n            Node.find(function (err, nodes) {\n                if (err) reject(err);\n\n                console.log(\"___findPromise\", nodes);\n                resolve(nodes);\n            });\n\n            //Kitten.find({ name: /^Fluff/ }, callback);\n        });\n\n        return new Promise(function(resolve, reject) {\n            Promise.all([\n                savePromise,\n                findPromise\n            ]).then(function(results) {\n                resolve(results);\n            }).catch(function(err) {\n                reject();\n            });\n        });\n    }\n}\n\ntry {\n    var controller = new Controller();\n} catch(err) {\n    logger.error(err);\n}\n\n\nmodule.exports = controller;\n"],"sourceRoot":"/source/"}