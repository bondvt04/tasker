{"version":3,"sources":["db/index.js"],"names":[],"mappings":";;;;;;AAIA,IAAI,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;AAC/B,IAAI,MAAM,GAAG,OAAO,CAAC,qBAAqB,CAAC,CAAC;;AAE5C,IAAI,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE,CAAC;AAC1C,IAAI,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;;AAEnC,QAAQ,CAAC,EAAE,CAAC,OAAO,EAAE,UAAS,GAAG,EAAE;AAC/B,UAAM,CAAC,GAAG,CAAC,gCAAgC,CAAC,GAAG,EAAE,GAAG,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC;AAC7E,WAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;CACnB,CAAC,CAAC;;AAEH,QAAQ,CAAC,GAAG,CAAC,YAAW;AACpB,QAAI,OAAO,GAAG;;;;;;;;KAQb,CAAC;;;AAGF,YAAQ,CAAC,OAAO,CAAC,4BAA4B,EAAE,OAAO,CAAC,CAAC;;AAExD,QAAI,EAAE,GAAG,QAAQ,CAAC,UAAU,CAAC;;;;;AAK7B,MAAE,CAAC,EAAE,CAAC,OAAO,EAAE,UAAS,GAAG,EAAE;AACzB,cAAM,CAAC,KAAK,CAAC,sBAAsB,CAAC,GAAG,EAAE,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;;AAE1D,YAAG,sBAAsB,IAAI,GAAG,CAAC,OAAO,EAAE;AACtC,kBAAM,CAAC,KAAK,CAAC,yFAAyF,CAAC,OAAO,CAAC,CAAC;SACnH;;AAED,gBAAQ,CAAC,IAAI,EAAE,CAAC;AAChB,eAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;KACnB,CAAC,CAAC;;AAEH,MAAE,CAAC,IAAI,CAAC,MAAM,EAAE,SAAS,QAAQ,GAAG;;AAEhC,cAAM,CAAC,GAAG,CAAC,8BAA8B,CAAC,KAAK,CAAC,CAAC;;KAEpD,CAAC,CAAC;CACN,CAAC,CAAC;;AAEH,MAAM,CAAC,OAAO,GAAG,QAAQ,CAAC","file":"db/index.js","sourcesContent":["/**\n * Created by anatoliybondar on 8/21/15.\n */\n\nvar colors = require('colors');\nvar logger = require(\"verbose-console-log\");\n\nvar dbDomain = require('domain').create();\nvar mongoose = require('mongoose');\n\ndbDomain.on('error', function(err) {\n    logger.log('Something wrong in DB domain: '.red, err.message.red, err.stack);\n    process.exit(1);\n});\n\ndbDomain.run(function() {\n    var options = {\n        //server: {\n        //    socketOptions: {\n        //        socketTimeoutMS: 100,\n        //        connectTimeoutMS: 100,\n        //        noDelay: true\n        //    }\n        //}\n    };\n\n    //mongoose.createConnection('mongodb://localhost/tasker', options);\n    mongoose.connect('mongodb://localhost/tasker', options);\n\n    var db = mongoose.connection;\n\n    //dbDomain.add(db);\n    //db.on('error', logger.error.bind(logger, 'connection error:'));\n\n    db.on('error', function(err) {\n        logger.error(\"Db connection error:\".red, err.message.red);\n\n        if(\"connect ECONNREFUSED\" == err.message) {\n            logger.error(\"Try to run 'mongod --config YOUR_MONGODB_CONF' (/etc/mongodb.conf or something similar)\".magenta);\n        }\n\n        dbDomain.exit();\n        process.exit(1);\n    });\n\n    db.once('open', function callback() {\n        // Соединение прошло успешно\n        logger.log(\"Db connection was successful\".green);\n        //callback();\n    });\n});\n\nmodule.exports = mongoose;"],"sourceRoot":"/source/"}